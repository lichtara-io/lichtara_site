<!-- ==============================================
     BLOCO CANALIZADO: PORTAL CÓSMICO HOME – AURORA INTERATIVA
================================================= -->

<section id="portal-cosmico" style="position:relative; width:100%; height:100vh; overflow:hidden; background:#000;">

  <!-- Texto central / boas-vindas -->
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);color:white;text-align:center;z-index:10;">
    <h1 style="font-size:3rem;">Bem-vindo ao Lichtara</h1>
    <p style="font-size:1.5rem;">Explore o portal interdimensional</p>
  </div>

  <!-- ======================
       LAYER 1: CÉU ESTRELADO
  ====================== -->
  <canvas id="sky-layer" style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:1;"></canvas>

  <!-- ======================
       LAYER 2: PARTICULAS
  ====================== -->
  <canvas id="particles-layer" style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:2;"></canvas>

  <!-- ======================
       LAYER 3: COMETA
  ====================== -->
  <canvas id="comet-layer" style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:3;"></canvas>

  <!-- ======================
       LAYER 4: AURORA INTERATIVA (canvas)
  ====================== -->
  <canvas id="aurora-layer" style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:4; pointer-events:none;"></canvas>

  <!-- ======================
       LAYER 5: RASTRO DO MOUSE
  ====================== -->
  <canvas id="trail-layer" style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:5;"></canvas>

  <!-- ======================
       LAYER 6: ESTRELA-GUIA
  ====================== -->
  <canvas id="guidestar-layer" style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:6;"></canvas>

  <!-- ======================
       LAYER 7: CONSTELAÇÕES INTERATIVAS
  ====================== -->
  <canvas id="constellation-layer" style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:7;"></canvas>

</section>

<script>
  const layers = ['sky','particles','comet','aurora','trail','guidestar','constellation'];
  const canvases = {};
  const ctxs = {};
  layers.forEach(id=>{
    canvases[id] = document.getElementById(`${id}-layer`);
    ctxs[id] = canvases[id].getContext('2d');
    canvases[id].width = window.innerWidth;
    canvases[id].height = window.innerHeight;
  });

  // ======================
  // CÉU ESTRELADO
  // ======================
  const stars = [];
  for(let i=0;i<200;i++) stars.push({x:Math.random()*window.innerWidth, y:Math.random()*window.innerHeight, r:Math.random()*1.5+0.5});
  function drawSky(){
    const ctx = ctxs.sky;
    ctx.clearRect(0,0,window.innerWidth,window.innerHeight);
    stars.forEach(s=>{
      ctx.beginPath();
      ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
      ctx.fillStyle='white';
      ctx.fill();
    });
  }

  // ======================
  // PARTICULAS
  // ======================
  const particles = [];
  for(let i=0;i<100;i++){
    particles.push({x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,r:Math.random()*2+1,dx:(Math.random()-0.5)*0.5,dy:(Math.random()-0.5)*0.5});
  }
  function drawParticles(){
    const ctx = ctxs.particles;
    ctx.clearRect(0,0,window.innerWidth,window.innerHeight);
    particles.forEach(p=>{
      p.x+=p.dx; p.y+=p.dy;
      if(p.x<0)p.x=window.innerWidth;if(p.x>window.innerWidth)p.x=0;
      if(p.y<0)p.y=window.innerHeight;if(p.y>window.innerHeight)p.y=0;
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fillStyle='rgba(255,255,255,0.7)';
      ctx.fill();
    });
  }

  // ======================
  // COMETA
  // ======================
  const comet = {x:-100,y:100,dx:4,dy:1,r:5};
  function drawComet(){
    const ctx = ctxs.comet;
    ctx.clearRect(0,0,window.innerWidth,window.innerHeight);
    ctx.beginPath();
    ctx.arc(comet.x,comet.y,comet.r,0,Math.PI*2);
    ctx.fillStyle='white';
    ctx.fill();
    ctx.strokeStyle='rgba(255,255,255,0.3)';
    ctx.lineWidth=2;
    ctx.beginPath();
    ctx.moveTo(comet.x-10,comet.y-5);
    ctx.lineTo(comet.x-30,comet.y-15);
    ctx.stroke();
    comet.x+=comet.dx;
    comet.y+=comet.dy;
    if(comet.x>window.innerWidth){comet.x=-50; comet.y=Math.random()*window.innerHeight/2;}
  }

  // ======================
  // AURORA INTERATIVA
  // ======================
  const auroraImg = new Image();
  auroraImg.src = 'aurora.gif'; // coloque o GIF real no repositório
  const auroraCanvas = canvases.aurora;
  const auroraCtx = ctxs.aurora;
  const auroraOffset = {x:0,y:0};

  window.addEventListener('mousemove',e=>{
    auroraOffset.x = (e.clientX - window.innerWidth/2) * 0.02;
    auroraOffset.y = (e.clientY - window.innerHeight/2) * 0.02;
  });

  function drawAurora(){
    auroraCtx.clearRect(0,0,window.innerWidth,window.innerHeight);
    if(auroraImg.complete){
      auroraCtx.save();
      auroraCtx.globalAlpha = 0.5;
      auroraCtx.drawImage(auroraImg, auroraOffset.x, auroraOffset.y, window.innerWidth*1.05, window.innerHeight*1.05);
      auroraCtx.restore();
    }
  }

  // ======================
  // RASTRO DO MOUSE
  // ======================
  const trailParticles = [];
  const mouse = {x:0,y:0};
  window.addEventListener('mousemove',e=>{mouse.x=e.clientX; mouse.y=e.clientY;});
  function drawTrail(){
    const ctx = ctxs.trail;
    ctx.fillStyle='rgba(0,0,0,0.05)';
    ctx.fillRect(0,0,window.innerWidth,window.innerHeight);
    trailParticles.push({x:mouse.x,y:mouse.y,r:Math.random()*3+2});
    if(trailParticles.length>50) trailParticles.shift();
    trailParticles.forEach(p=>{
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fillStyle='rgba(255,255,255,0.7)';
      ctx.fill();
    });
  }

  // ======================
  // ESTRELA-GUIA
  // ======================
  const guideStar = {x:window.innerWidth/2,y:window.innerHeight/4,r:6};
  function drawGuideStar(){
    const ctx = ctxs.guidestar;
    ctx.clearRect(0,0,window.innerWidth,window.innerHeight);
    ctx.beginPath();
    ctx.arc(guideStar.x,guideStar.y,guideStar.r,0,Math.PI*2);
    ctx.fillStyle='yellow';
    ctx.fill();
  }

  // ======================
  // CONSTELAÇÕES INTERATIVAS
  // ======================
  const constellationStars = [];
  for(let i=0;i<40;i++){
    constellationStars.push({
      x:Math.random()*window.innerWidth,
      y:Math.random()*window.innerHeight,
      radius:Math.random()*3+2,
      active:false
    });
  }
  function drawConstellations(){
    const ctx = ctxs.constellation;
    ctx.clearRect(0,0,window.innerWidth,window.innerHeight);
    constellationStars.forEach(s=>{
      const dx = s.x - mouse.x;
      const dy = s.y - mouse.y;
      const dist = Math.sqrt(dx*dx+dy*dy);
      s.active = dist<50;
      ctx.beginPath();
      ctx.arc(s.x,s.y,s.active?s.radius*2:s.radius,0,Math.PI*2);
      ctx.fillStyle=s.active?'rgba(255,255,255,1)':'rgba(255,255,255,0.5)';
      ctx.fill();
      constellationStars.forEach(o=>{
        const dx2 = s.x-o.x;
        const dy2 = s.y-o.y;
        const dist2 = Math.sqrt(dx2*dx2+dy2*dy2);
        if(dist2<150){
          ctx.beginPath();
          ctx.moveTo(s.x,s.y);
          ctx.lineTo(o.x,o.y);
          ctx.strokeStyle=`rgba(255,255,255,${0.2+0.8*(1-dist2/150)})`;
          ctx.lineWidth=1;
          ctx.stroke();
        }
      });
    });
  }

  // ======================
  // ANIMAÇÃO PRINCIPAL
  // ======================
  function animate(){
    drawSky();
    drawParticles();
    drawComet();
    drawAurora();
    drawTrail();
    drawGuideStar();
    drawConstellations();
    requestAnimationFrame(animate);
  }
  animate();

  // ======================
  // RESIZE
  // ======================
  window.addEventListener('resize',()=>{
    layers.forEach(id=>{
      canvases[id].width = window.innerWidth;
      canvases[id].height = window.innerHeight;
    });
    guideStar.x = window.innerWidth/2;
  });
</script>
